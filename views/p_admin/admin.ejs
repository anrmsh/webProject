<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>Панель администратора</title>
    <link rel="stylesheet" href="/css/admin.css" />
  
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <header>
      <a href="/" class="logo">BanquetBook<span>.</span></a>
      <nav class="navbar">
        <a href="/admin/users">Пользователи</a>
        <a href="/admin/halls">Залы</a>
        <a href="/admin/calendar">Календарь событий</a>
        <a href="/admin/stats">Статистика</a>
      </nav>
      <div class="icons">
        <a href="/admin/notifications" class="fas fa-bell" title="Уведомления">
          <% if (notifications && notifications > 0) { %>
          <span class="notif-count"><%= notifications %></span>
          <% } %>
        </a>
        <a href="/logout" class="fas fa-right-from-bracket" title="Выйти"></a>
      </div>
    </header>

    <main class="admin-home">
      <h2>Добро пожаловать, <%= adminName %>!</h2>
      <p>
        Здесь вы можете управлять пользователями, залами и просматривать
        статистику.
      </p>

      <div class="dashboard-cards">
        <div class="card">
          <h3>Всего пользователей</h3>
          <p><%= totalUsers %></p>
        </div>
        <div class="card">
          <h3>Активных менеджеров</h3>
          <p><%= activeManagers %></p>
        </div>
        <div class="card">
          <h3>Всего бронирований</h3>
          <p><%= totalBookings %></p>
        </div>
        <div class="card">
          <h3>Общая сумма заказов</h3>
          <p><%= totalRevenue %> ₽</p>
        </div>
      </div>
      <section class="charts">
        <div class="charts-container">
          <div class="chart-wrapper">
            <h3>График заказов за последние 7 дней</h3>
            <canvas id="bookingsChart"></canvas>
          </div>
          <div class="chart-wrapper">
            <h3>Сумма бронирований по залам</h3>
            <canvas id="hallChart"></canvas>
          </div>
        </div>
      </section>
    </main>

    <script>
      window.chartLabels = <%- JSON.stringify(chartLabels || []) %>;
      window.chartData = <%- JSON.stringify(chartData || []) %>;
      window.hallSums = <%- JSON.stringify(hallSums || {}) %>;
    </script>
    <script src="/script/adminCharts.js"></script>
  </body>
</html>
